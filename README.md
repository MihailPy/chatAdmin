# Анализ проекта: Бот-антиспамер для Telegram

## Описание проекта
Это Telegram-бот, предназначенный для автоматической модерации чатов. Основные функции:
- Автоматическое мутирование новых участников чата при подозрении на спам
- Логирование действий и информации о пользователях
- Требует прав администратора с возможностью удалять сообщения и ограничивать участников

## Технический стек
- Python 3.x
- Aiogram 2.11.2 (асинхронная библиотека для Telegram Bot API)
- PyMySQL для работы с базой данных MySQL
- Docker и Docker Compose для развертывания
- Loguru для логирования

## Установка и настройка

### Предварительные требования
1. Установите Docker и Docker Compose:
```bash
sudo apt install docker.io docker-compose
```

2. Клонируйте репозиторий:
```bash
git clone https://github.com/MihailPy/chatAdmin.git
cd chatAdmin
```

### Настройка конфигурации
1. Отредактируйте файл `db/createdb.sql`:
   - Замените `mysqlrootpassword` на надежный пароль для root-пользователя MySQL
   - Запомните установленный пароль

2. Отредактируйте файл `docker-compose.yml`:
   - Замените `mysqlrootpassword` на тот же пароль, что и в createdb.sql
   - Укажите ваш Telegram ID в поле `admin_id`

3. Перед запуском:
   - Напишите любому сообщение вашему боту, чтобы он мог отправить вам уведомление о запуске

### Запуск проекта
```bash
sudo docker-compose up -d
```

## Управление контейнерами
- Просмотр запущенных контейнеров:
```bash
docker ps -a
```

- Остановка и удаление контейнеров:
```bash
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
```

## Функционал бота
1. **Автомодерация чата**:
   - При добавлении нового участника проверяет его историю
   - Если участник подозрителен (уже есть в базе, но в другом чате), автоматически мутирует его

2. **Команды**:
   - `/start` - базовая команда для проверки работы бота

3. **Уведомления**:
   - При запуске бот отправляет сообщение администратору

## Структура проекта
- `main.py` - точка входа, инициализация бота
- `handlers.py` - обработчики сообщений и событий
- `db.py` - работа с базой данных
- `config.py` - конфигурационные параметры (не показан в предоставленных файлах)
- `requirements.txt` - зависимости Python
- `docker-compose.yml` - конфигурация Docker

## Важные замечания
1. Боту требуются права администратора в чате с возможностями:
   - Удалять сообщения
   - Ограничивать участников (мут)

2. Для корректной работы необходимо:
   - Предварительно написать боту в личные сообщения
   - Указать правильный `admin_id` в конфигурации

3. Логирование:
   - Логи сохраняются в `log/file.log` с ротацией раз в неделю

4. Временная зона:
   - Используется Europe/Moscow (может быть изменено в handlers.py)

Проект требует доработки конфигурационного файла и возможной настройки параметров базы данных для production-использования.
